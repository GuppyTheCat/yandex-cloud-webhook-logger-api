# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ: Webhook Logger API (HMAC Validation)

## üìã –í–≤–µ–¥–µ–Ω–∏–µ

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2-3 —á–∞—Å–∞ (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ò–ò –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Claude/Codex –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –Ω–∞ —Å–≤–æ–µ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ)
**–¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è:** –û—Ü–µ–Ω–∏—Ç—å –≤–∞—à–µ —É–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å Yandex Cloud serverless –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏

–í—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ serverless –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–∏—ë–º–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è webhook —Å–æ–±—ã—Ç–∏–π –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

**–ë–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–π:**
- –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç POST –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ–¥–∏–Ω—ã–π endpoint `/webhook`
- –ó–∞–ø—Ä–æ—Å—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã HMAC signature –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Å—Ç—Ä–æ (< 200ms) –ø—Ä–∏–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å –∏ –≤–µ—Ä–Ω—É—Ç—å 200 OK
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤ —Ñ–æ–Ω–µ
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ API

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- Webhook –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–∏ –æ–∂–∏–¥–∞—é—Ç –±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç, –∏–Ω–∞—á–µ —Å—á–∏—Ç–∞—é—Ç –¥–æ—Å—Ç–∞–≤–∫—É –Ω–µ—É–¥–∞—á–Ω–æ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ–π (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–∞—Ä—Å–∏–Ω–≥, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î)
- –ù—É–∂–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–∂–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –î–û–õ–ñ–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. FAST WEBHOOK RECEIVER (Cloud Function)           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
External Service (GitHub/Stripe)
  ‚Üì POST /webhook
  ‚Üì Headers: X-Webhook-Signature: sha256=abc123...
webhook-receiver Function
  ‚Üì Validate HMAC signature (SECRET_KEY from Lockbox)
  ‚Üì Enqueue to YMQ (Standard Queue)
  ‚Üì Return 200 OK (~100-150ms)

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. MESSAGE QUEUE (YMQ Standard)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
YMQ Standard Queue: webhook-events
  Settings:
    - Visibility Timeout: 300s (5 min)
    - Message Retention: 86400s (24 hours)
    - Batch size: 10

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. ASYNC PROCESSOR (Container + YMQ Trigger)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
YMQ Trigger ‚Üí Auto-invokes Container
  ‚Üì
webhook-processor (FastAPI Container)
  ‚Üì Parse message from YMQ
  ‚Üì Validate JSON structure
  ‚Üì Save to YDB (webhook_logs table)
  ‚Üì Return success
```

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
1. **Fast Response:** Receiver –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK –∑–∞ < 200ms (–±–µ–∑ —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
2. **Separation of Concerns:** –ü—Ä–∏—ë–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã
3. **Guaranteed Processing:** YMQ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É –¥–∞–∂–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ processor
4. **Security:** HMAC signature –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ YC –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. **YDB Serverless** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
2. **Cloud Function** (Python 3.12) - webhook-receiver
3. **YMQ Standard Queue** - –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
4. **YMQ Trigger** - –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
5. **Serverless Container** (Python 3.12 + FastAPI) - webhook-processor
6. **Lockbox** - SECRET_KEY –¥–ª—è HMAC
7. **Service Account** - –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º


## üìä YDB –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: `webhook_logs`

```sql
CREATE TABLE webhook_logs (
    log_id Utf8 NOT NULL,              -- UUID —Å–æ–±—ã—Ç–∏—è
    received_at Timestamp NOT NULL,     -- –ö–æ–≥–¥–∞ –ø–æ–ª—É—á–µ–Ω webhook
    event_type Utf8,                    -- –¢–∏–ø —Å–æ–±—ã—Ç–∏—è (–∏–∑ JSON payload)
    payload_json JsonDocument,          -- –ü–æ–ª–Ω—ã–π JSON payload
    signature Utf8,                     -- HMAC signature –∏–∑ headers
    processed_at Timestamp,             -- –ö–æ–≥–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω (NULL –¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
    PRIMARY KEY (log_id)
);
```


---

## üîå API –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### 1. POST /webhook - –ü—Ä–∏—ë–º webhook —Å–æ–±—ã—Ç–∏—è

**Endpoint:** `https://your-function-url/webhook`

**Request Headers:**
```
Content-Type: application/json
X-Webhook-Signature: sha256=<hmac_hex>
```

**Request Body:**
```json
{
  "event_type": "payment.success",
  "data": {
    "order_id": "12345",
    "amount": 1000
  }
}
```

**HMAC Signature Calculation:**
```python
import hmac
import hashlib

secret_key = "your-secret-key-from-lockbox"
payload = '{"event_type":"payment.success",...}'  # Raw JSON body
signature = hmac.new(
    secret_key.encode(),
    payload.encode(),
    hashlib.sha256
).hexdigest()
# Header: X-Webhook-Signature: sha256={signature}
```

**Response (Success):**
```json
HTTP 200 OK
{
  "status": "received",
  "log_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

**Response (Invalid Signature):**
```json
HTTP 401 Unauthorized
{
  "error": "Invalid signature"
}
```

---

### 2. GET /webhook/logs - –ò—Å—Ç–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π

**Endpoint:** `https://your-function-url/webhook/logs`

**Query Parameters:**
- `limit` (optional, default=50, max=100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π
- `event_type` (optional) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è

**Response:**
```json
HTTP 200 OK
{
  "logs": [
    {
      "log_id": "550e8400-e29b-41d4-a716-446655440000",
      "received_at": "2025-11-20T10:30:00Z",
      "event_type": "payment.success",
      "payload_json": {...},
      "processed_at": "2025-11-20T10:30:02Z"
    }
  ],
  "total": 1
}
```

---

## ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. webhook-receiver (Cloud Function)

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è HMAC signature (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å SECRET_KEY –∏–∑ Lockbox)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ `log_id` (UUID)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è –≤ YMQ Standard Queue
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 200 OK –∑–∞ < 200ms
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 401 –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–π signature
- ‚úÖ Structured logging (INFO/WARNING/ERROR)

**–ù–ï –¥–µ–ª–∞—Ç—å –≤ receiver:**
- ‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ YDB (—Ç–æ–ª—å–∫–æ –≤ processor!)
- ‚ùå –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON payload
- ‚ùå –¢—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

---

### 2. webhook-processor (Serverless Container)

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—Ä–∏–µ–º –±–∞—Ç—á–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç YMQ Trigger (–¥–æ 10 —Å–æ–æ–±—â–µ–Ω–∏–π)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ message.body (JSON)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ YDB (—Ç–∞–±–ª–∏—Ü–∞ `webhook_logs`)
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `processed_at` timestamp
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (try/except —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
- ‚úÖ –í–æ–∑–≤—Ä–∞—Ç 200 OK (—á—Ç–æ–±—ã YMQ —É–¥–∞–ª–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ)

**Endpoint:** `POST /ymq-trigger`

**Request Body (–æ—Ç YMQ Trigger):**
```json
{
  "messages": [
    {
      "event_metadata": {...},
      "details": {
        "message": {
          "message_id": "abc-123",
          "body": "{\"log_id\":\"...\",\"event_type\":\"...\",\"payload\":{...}}"
        }
      }
    }
  ]
}
```

---

### 3. logs-api (Cloud Function - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤—Ä–µ–º—è**, –¥–æ–±–∞–≤—å—Ç–µ endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏:
- `GET /webhook/logs?limit=50&event_type=payment.success`
- –ó–∞–ø—Ä–æ—Å –≤ YDB —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `event_type`

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

### **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ (–±–µ–∑ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏–µ –Ω–µ –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è):**


1. **‚úÖ Architecture Pattern:**
   - Fast receiver (< 200ms response)
   - YMQ –¥–ª—è async processing
   - Container –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–∞—Ç—á–∏

2. **‚úÖ Security:**
   - HMAC signature –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
   - SECRET_KEY –∏–∑ Lockbox (–Ω–µ hardcoded!)
   - 401 –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–π signature

3. **‚úÖ Working Demo:**
   - –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å webhook —Å –≤–∞–ª–∏–¥–Ω–æ–π signature ‚Üí 200 OK
   - –°–æ–±—ã—Ç–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ YDB —á–µ—Ä–µ–∑ 1-5 —Å–µ–∫—É–Ω–¥
   - –ú–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ API

---

### **–ü–ª—é—Å—ã (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–∞–ª–ª—ã):**

1. **‚≠ê Code Quality:**
   - –£–¥–µ–ª—è–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤—É –∫–æ–¥–∞ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º

2. **‚≠ê Error Handling:**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ Retry –ª–æ–≥–∏–∫–∞

3. **‚≠ê Logging:**
   - –£—Ä–æ–≤–Ω–∏: DEBUG/INFO/WARNING/ERROR, –Ω–∞ –¥–µ–º–æ —Å—ç–º—É–ª–∏—Ä—É–π—Ç–µ 1-Error , –ª–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Cloud loging YC

4. **‚≠ê Documentation:**
   - README.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –¥–µ–ø–ª–æ—é
   - –ü—Ä–∏–º–µ—Ä—ã curl –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

5. **‚≠ê Testing:**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è HMAC validation
   - Integration —Ç–µ—Å—Ç (–æ—Ç–ø—Ä–∞–≤–∫–∞ webhook ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ YDB)
   - –°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–Ω—ã—Ö signatures

---

### **–ú–∏–Ω—É—Å—ã (—á—Ç–æ –ù–ï –Ω–∞–¥–æ –¥–µ–ª–∞—Ç—å):**

1. **‚ùå Anti-patterns:**
   - Sync –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ receiver (–¥–æ–ª–≥–∏–π –æ—Ç–≤–µ—Ç)
   - Hardcoded credentials –≤ –∫–æ–¥–µ
   - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ signature validation

2. **‚ùå Over-engineering:**
   - –°–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–±–æ–ª—å—à–µ 3 —Ñ—É–Ω–∫—Ü–∏–π)
   - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Kubernetes –≤–º–µ—Å—Ç–æ serverless

---

## üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã


### **–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**

**Yandex Cloud Docs:**
- [YDB Python SDK](https://ydb.tech/docs/ru/reference/ydb-sdk/example/python/) - –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å YDB
- [Cloud Functions](https://cloud.yandex.ru/docs/functions/) - –¥–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–π
- [YMQ](https://cloud.yandex.ru/docs/message-queue/) - —Ä–∞–±–æ—Ç–∞ —Å –æ—á–µ—Ä–µ–¥—è–º–∏
- [Serverless Containers](https://cloud.yandex.ru/docs/serverless-containers/) - –¥–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- [Lockbox](https://cloud.yandex.ru/docs/lockbox/) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏



---

## üì¶ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å

### 1. **–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥** (Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ ZIP –∞—Ä—Ö–∏–≤)

```
webhook-logger/
‚îú‚îÄ‚îÄ README.md                    # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é
‚îú‚îÄ‚îÄ webhook-receiver/            # Cloud Function
‚îÇ   ‚îú‚îÄ‚îÄ handler.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ webhook-processor/           # Serverless Container
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # FastAPI app
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ ydb_schemas/
‚îÇ   ‚îî‚îÄ‚îÄ webhook_logs.sql         # CREATE TABLE
‚îî‚îÄ‚îÄ test_webhook.sh              # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### 2. **README.md** —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏:
- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å YDB —Ç–∞–±–ª–∏—Ü—É
- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å YMQ queue
- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å Lockbox secret
- –ö–∞–∫ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- –ü—Ä–∏–º–µ—Ä—ã curl –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 3. **–í–∏–¥–µ–æ –¥–µ–º–æ** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è):
- 2-3 –º–∏–Ω—É—Ç—ã screencast
- –ü–æ–∫–∞–∑–∞—Ç—å: –æ—Ç–ø—Ä–∞–≤–∫–∞ webhook ‚Üí –ø–æ—è–≤–ª–µ–Ω–∏–µ –≤ YDB
- –û–±—ä—è—Å–Ω–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

### 4. **Deployment URLs:**
- URL webhook receiver —Ñ—É–Ω–∫—Ü–∏–∏
- Lockbox secret ID (–±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è!)
- YDB database path

---

## ‚è±Ô∏è –¢–∞–π–º–∏–Ω–≥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

**–û–±—â–µ–µ –≤—Ä–µ–º—è: 2-3 —á–∞—Å–∞**

- **30 –º–∏–Ω** - –ò–∑—É—á–µ–Ω–∏–µ YC docs —Å –ø–æ–º–æ—â—å—é AI, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CLI
- **30 –º–∏–Ω** - –°–æ–∑–¥–∞–Ω–∏–µ YDB, YMQ, Lockbox —á–µ—Ä–µ–∑ YC Console
- **60 –º–∏–Ω** - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ webhook-receiver + processor (—Å AI –ø–æ–º–æ—â—å—é)
- **30 –º–∏–Ω** - –î–µ–ø–ª–æ–π –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **30 –º–∏–Ω** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README.md)

**–ï—Å–ª–∏ –∑–∞—Å—Ç—Ä—è–ª–∏:** –ù–µ —Ç—Ä–∞—Ç—å—Ç–µ –±–æ–ª—å—à–µ 30 –º–∏–Ω—É—Ç –Ω–∞ –æ–¥–Ω—É –ø—Ä–æ–±–ª–µ–º—É - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ AI –∏–ª–∏ –∏–¥–∏—Ç–µ –¥–∞–ª—å—à–µ.

---

**–ì–ª–∞–≤–Ω–æ–µ —á—Ç–æ –º—ã –æ—Ü–µ–Ω–∏–≤–∞–µ–º:**
1. –£–º–µ–Ω–∏–µ –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –Ω–æ–≤–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π (YC)
2. –ü–æ–Ω–∏–º–∞–Ω–∏–µ serverless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

–£–¥–∞—á–∏! üöÄ
